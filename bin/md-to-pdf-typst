#!/usr/bin/env bash

if [ $# -ne 1 ]; then
	echo "Correct number of arguments not specified"
	echo "Usage: $0 <markdown-file>"
	exit
fi

outfile=$(basename "$1" .md)

echo "Converting file using pandoc and Typst"

tmpfile=$(mktemp)

pandoc "$1" -o "$tmpfile" --from markdown+yaml_metadata_block+raw_html --to typst
[[ "$?" -ne 0 ]] && echo "Could not convert from md to typ" && exit 1

typst compile "$tmpfile" "./${outfile}.pdf"
[[ "$?" -ne 0 ]] && echo "Could not convert from typ to pdf" && exit 1

echo "Generated file $outfile-generated.pdf"
